Fase				Descrizione
1. Preparazione dati		Si parte da archivi compressi, si ottengono le letture grezze, si puliscono e si rimuovono le contaminazioni da genoma ospite.
2. Analisi tassonomica		Le letture filtrate vengono analizzate per determinare quali microrganismi sono presenti e in quale abbondanza.
3. Analisi funzionale		Le stesse letture sono analizzate per capire quali geni/funzioni metaboliche sono codificate.
4. Assemblaggio			Le letture vengono assemblate in contig, cioè frammenti di genoma più lunghi.
5. MAG binning e valutazione	I contig vengono raggruppati in genomi metagenomici (MAGs), poi valutati per qualità e completezza.
6. Annotazione			I MAG validi vengono annotati con tool che identificano geni, funzioni, resistenze, ecc.

1. Preparazione dati
   ├── Estrazione file fastq
   ├── Rimozione adattatori e trimming
   └── Filtraggio delle letture contaminate da genoma ospite(Bowtie2)

2. Analisi tassonomica
   ├── Profilazione tassonomica per campione (MetaPhlAn)
   └── Aggregazione e analisi della diversità microbica

3. Analisi funzionale
   ├── Assegnazione delle funzioni geniche (HUMAnN)
   └── Unione e sintesi delle tabelle funzionali

4. Assemblaggio del metagenoma
   └── Assemblaggio delle letture in contig (SPAdes)

5. Estrazione e analisi dei MAG (Metagenome-Assembled Genomes)
   ├── Filtro contig e creazione indice MAG
   ├── Mappatura delle letture e calcolo profondità(Bowtie2, Samtools)
   ├── Binning dei contig (MetaBAT)
   └── Valutazione qualità MAG (CheckM)

6. Selezione e annotazione genomica
   ├── Filtro MAG ad alta qualità
   ├── Creazione metadata per annotazione
   └── Annotazione genomica dei MAG (TORMES)

//////LINK/////			//////LINK/////			//////LINK/////			//////LINK/////
https://www.mermaidchart.com/raw/be505ff5-6598-4503-9764-3214ead74fcf?theme=light&version=v0.1&format=svg      diagramma!!!!


INPUT INIZIALI
Tipo di input		Contenuto
archive.tar 		(.fq.gz)	
host.fasta		Host da rimuovere
simple list		

1. Preparazione dati
Step				Tool			Input				Output
Estrazione .fq.gz		bash (tar)		archive.tar			raw/*.fq.gz
Rimozione adattatori		AdapterRemoval		raw/*.fq.gz			cleaned/*.fq.gz
Rimozione ospite		Bowtie2			cleaned/*.fq.gz, host.fasta	filtered_reads/*.fq.gz

2. Analisi tassonomica
Step				Tool			Input				Output
Profilazione per campione	MetaPhlAn		filtered_reads/*.fq.gz		tax_profile.txt
Merge profili			script			tax_profile.txt (multipli)	merged_tax.tsv
Analisi diversità alfa/beta	R / python		merged_tax.tsv			plot/, diversity stats

3. Analisi funzionale
Step				Tool			Input				Output
Annotazione funzionale		HUMAnN			filtered_reads/*.fq.gz		humann_gene_families.tsv
Merge tabelle funzionali	humann_join_tables	*.tsv da HUMAnN			merged_humann.tsv

4. Assemblaggio del metagenoma
Step				Tool			Input				Output
Assemblaggio			SPAdes			filtered_reads/*.fq.gz		contigs.fasta
Filtro contigs			bash/python		contigs.fasta			contigs_filtered.fasta

5. Estrazione e analisi dei MAG
Step				Tool			Input					Output
Indice MAG			bowtie2-build		contigs_filtered.fasta			mag_index.bt2
Mappatura + copertura		bowtie2 + samtools	filtered_reads/*.fq.gz, mag_index.bt2	mapped.bam, coverage.tsv
Profondità			custom script		mapped.bam				depth.txt
Binning				MetaBAT			contigs_filtered.fasta, depth.txt	MAGs/*.fasta
Qualità MAG			CheckM, CheckM2		MAGs/*.fasta				quality_report.tsv
Filtro MAG			bash			MAGs/, quality_report.tsv		filtered_MAGs/

6. Annotazione genomica
Step				Tool			Input				Output
Metadata			bash			sample list			metadata.tsv
Annotazione MAGs		TORMES			filtered_MAGs/, metadata.tsv	annotated_MAGs/

Output finali complessivi
	Tipo di output		Contenuto
	annotated_MAGs/		Genomi batterici annotati (MAGs)
	diversity/, plot/	Analisi di biodiversità microbioma
	merged_humann.tsv	Funzioni geniche aggregate
	merged_tax.tsv		Tassonomia aggregata